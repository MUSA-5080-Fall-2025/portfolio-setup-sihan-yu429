"0","# Transform to appropriate projected CRS"
"0","library(units)"
"0","vulnerable_tracts_proj <- st_transform(vulnerable_tracts, 5070)"
"0","hospitals_proj <- st_transform(hospitals, 5070)"
"0",""
"0","tract_centroids <- st_centroid(vulnerable_tracts_proj)"
"0","# Calculate distance from each tract centroid to nearest hospital"
"0","dist_matrix <- st_distance(tract_centroids, hospitals_proj)"
"0","nearest_hospital_dist_m <- apply(dist_matrix, 1, min)"
"0",""
"0","nearest_hospital_dist_miles <- as.numeric(nearest_hospital_dist_m)/1609.34"
"0",""
"0","vulnerable_tracts_proj <- vulnerable_tracts_proj %>%"
"0","  mutate(distance_to_hospital_miles = nearest_hospital_dist_miles)"
"0",""
"0","avg_distance <- mean(vulnerable_tracts_proj$distance_to_hospital_miles, na.rm = TRUE)"
"0","max_distance <- max(vulnerable_tracts_proj$distance_to_hospital_miles, na.rm = TRUE)"
"0","num_over_15 <- sum(vulnerable_tracts_proj$distance_to_hospital_miles > 15, na.rm = TRUE)"
"0",""
"0","cat("
"0","  ""Average distance to nearest hospital (miles):"", round(avg_distance, 2), ""\n"","
"0","  ""Maximum distance to nearest hospital (miles):"", round(max_distance, 2), ""\n"","
"0","  ""Number of vulnerable tracts >15 miles from hospital:"", num_over_15, ""\n"""
"0",")"
"1","Average distance to nearest hospital (miles):"
"1"," "
"1","4.75"
"1"," "
"1","
"
"1"," "
"1","Maximum distance to nearest hospital (miles):"
"1"," "
"1","19.32"
"1"," "
"1","
"
"1"," "
"1","Number of vulnerable tracts >15 miles from hospital:"
"1"," "
"1","10"
"1"," "
"1","
"
