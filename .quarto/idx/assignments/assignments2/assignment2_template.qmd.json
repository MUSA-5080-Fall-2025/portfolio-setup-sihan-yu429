{"title":"Assignment 2: Spatial Analysis and Visualization","markdown":{"yaml":{"title":"Assignment 2: Spatial Analysis and Visualization","subtitle":"Healthcare Access and Equity in Pennsylvania","author":"Sihan Yu","date":"today","format":{"html":{"code-fold":false,"toc":true,"toc-location":"left","theme":"cosmo","embed-resources":true}},"execute":{"warning":false,"message":false}},"headingText":"Assignment Overview","containsRefs":false,"markdown":"\n\n\n**Learning Objectives:**\n- Apply spatial operations to answer policy-relevant research questions\n- Integrate census demographic data with spatial analysis\n- Create publication-quality visualizations and maps\n- Work with spatial data from multiple sources\n- Communicate findings effectively for policy audiences\n\n---\n\n## Part 1: Healthcare Access for Vulnerable Populations\n\n### Research Question\n\n**Which Pennsylvania counties have the highest proportion of vulnerable populations (elderly + low-income) living far from hospitals?**\n\n\n#### Step 1: Data Collection (5 points)\n\nLoad the required spatial data:\n- Pennsylvania county boundaries\n- Pennsylvania hospitals (from lecture data)\n- Pennsylvania census tracts\n\n**Your Task:**\n```{r}\n# Load required packages\n\nlibrary(sf)\nlibrary(tidyverse)\nlibrary(tigris)\nlibrary(tidycensus)\nlibrary(scales)\nlibrary(patchwork)\nlibrary(here)\n\n# Set Census API key\ncensus_api_key(\"e173851c633e89c20243632174db68f63bac8856\")\n\n# Load spatial data\n\npa_counties <- st_read(here(\"assignments/assignments2/data/Pennsylvania_County_Boundaries.shp\"))\nhospitals <- st_read(here(\"assignments/assignments2/data/hospitals.geojson\"))\ncensus_tracts <- tracts(state = \"PA\", cb = TRUE, progress_bar = FALSE)\n\n\n# Standardize CRS\nhospitals <- st_transform(hospitals, st_crs(pa_counties))\ncensus_tracts <- st_transform(census_tracts, st_crs(pa_counties))\n\n# check that all data loaded correctly\n\n# Number of hospitals\nn_hospitals <- nrow(hospitals)\n\n\n# Number of census tracts\nn_tracts <- nrow(census_tracts)\n\ncat(\"Number of hospitals:\", nrow(hospitals), \"\\n\")\ncat(\"Number of census tracts:\", nrow(census_tracts), \"\\n\")\n\ncat(\"\\nCoordinate Reference Systems (CRS):\\n\")\ncat(\"Counties:\", st_crs(pa_counties)$input, \"\\n\")\ncat(\"Hospitals:\", st_crs(hospitals)$input, \"\\n\")\ncat(\"Census tracts:\", st_crs(census_tracts)$input, \"\\n\")\n\n\n```\n\n# Check that all data loaded correctly\n\n\n**Questions to answer:**<br>\n-  How many hospitals are in your dataset?<br>\n   There are 223 hospitals in the dataset.<br>\n-  How many census tracts?<br>\n   There are 3445 census tracts.<br>\n-  What coordinate reference system is each dataset in?<br>\n   They share the same coordinate reference system: WGS 84.\n\n---\n\n#### Step 2: Get Demographic Data \n\nUse `tidycensus` to download tract-level demographic data for Pennsylvania.\n\n**Required variables:**\n- Total population\n- Median household income\n- Population 65 years and over (you may need to sum multiple age categories)\n\n**Your Task:**\n\n\n\n```{r}\n# Get demographic data from ACS\n#### Step 2: Get Demographic Data ----\n\npa_demo <- get_acs(\n  geography = \"tract\",\n  state = \"PA\",\n  year = 2022,             \n  survey = \"acs5\",\n  variables = c(\n    total_pop = \"B01003_001\",       # Total population\n    median_income = \"B19013_001\",   # Median household income\n    age_65_66 = \"B01001_020\",       # Male 65–66\n    age_67_69 = \"B01001_021\",\n    age_70_74 = \"B01001_022\",\n    age_75_79 = \"B01001_023\",\n    age_80_84 = \"B01001_024\",\n    age_85_plus = \"B01001_025\",\n    f_65_66 = \"B01001_044\",         # Female 65–66\n    f_67_69 = \"B01001_045\",\n    f_70_74 = \"B01001_046\",\n    f_75_79 = \"B01001_047\",\n    f_80_84 = \"B01001_048\",\n    f_85_plus = \"B01001_049\"\n  ),\n  output = \"wide\"\n)\n\n\npa_demo <- pa_demo %>%\n  mutate(\n    pop_65_over = age_65_66E + age_67_69E + age_70_74E + age_75_79E +\n                  age_80_84E + age_85_plusE +\n                  f_65_66E + f_67_69E + f_70_74E + f_75_79E +\n                  f_80_84E + f_85_plusE\n  ) %>%\n  select(GEOID, total_pop = total_popE, median_income = median_incomeE, pop_65_over)\n\n\n\n# Join to tract boundaries\ncensus_tracts_demo <- census_tracts %>%\n  left_join(pa_demo, by = \"GEOID\")\n\n\n# 1. What year of ACS data are you using?\nacs_year <- 2022\ncat(\"ACS Year Used:\", acs_year, \"\\n\")\n\n# 2. How many tracts have missing income data?\nmissing_income <- sum(is.na(census_tracts_demo$median_income))\ncat(\"Number of tracts with missing income data:\", missing_income, \"\\n\")\n\n# 3. What is the median income across all PA census tracts?\nmedian_income_pa <- median(census_tracts_demo$median_income, na.rm = TRUE)\ncat(\"Median income across all PA census tracts:\", dollar(median_income_pa), \"\\n\")\n\n\n\n```\n\n\n**Questions to answer:**<br>\n-  What year of ACS data are you using?<br>\n   I used data of 2022.<br>\n-  How many tracts have missing income data?<br>\n   There are 62 tracts missing.<br>\n-  What is the median income across all PA census tracts?<br>\n   The medium income across all PA census tracts is $70,188. \n---\n\n#### Step 3: Define Vulnerable Populations \n\nIdentify census tracts with vulnerable populations based on TWO criteria:\n1. Low median household income (choose an appropriate threshold)\n2. Significant elderly population (choose an appropriate threshold)\n\n**Your Task:**\n```{r}\n# Filter for vulnerable tracts based on your criteria\nincome_threshold <- quantile(census_tracts_demo$median_income, 0.25, na.rm = TRUE)\nelderly_threshold <- quantile(\n  (census_tracts_demo$pop_65_over / census_tracts_demo$total_pop), \n  0.75, \n  na.rm = TRUE\n)\n\ncat(\"Low-income threshold:\", scales::dollar(income_threshold), \"\\n\")\ncat(\"High-elderly threshold (share of 65+):\", scales::percent(elderly_threshold), \"\\n\")\n\ncensus_tracts_demo <- census_tracts_demo %>%\n  mutate(\n    elderly_share = pop_65_over / total_pop\n  )\n\nvulnerable_tracts <- census_tracts_demo %>%\n  filter(\n    median_income <= income_threshold &\n    elderly_share >= elderly_threshold\n  )\ncat(\"Number of vulnerable tracts identified:\", nrow(vulnerable_tracts), \"\\n\")\n\ntotal_tracts <- nrow(census_tracts_demo)\nvulnerable_count <- nrow(vulnerable_tracts)\nvulnerable_pct <- (vulnerable_count / total_tracts) * 100\ncat(\"Percentage of PA census tracts considered vulnerable:\", round(vulnerable_pct, 1), \"%\\n\")\n\n```\n\n**Questions to answer:**<br>\n-  What income threshold did you choose and why?<br>\n   I used $55,923.50 has the income threshold. It is based on the percentiles of the general income data and this is the benchmarks of the bottom 25% of the income across Pennsylvania counties.<br>\n-  What elderly population threshold did you choose and why?<br>\n   I used the same method as for the income threshold. I used the top 25% elderly share(23%) as my threshold. <br>\n-  How many tracts meet your vulnerability criteria?<br>\n   There are 165 tracts meet my vulnerability criteria.<br>\n-  What percentage of PA census tracts are considered vulnerable by your definition?<br>\n   There are 4.8% of PA census tracts that are vulnerable.\n---\n\n#### Step 4: Calculate Distance to Hospitals \n\nFor each vulnerable tract, calculate the distance to the nearest hospital.\n\n**Your Task:**\n```{r}\n# Transform to appropriate projected CRS\nlibrary(units)\nvulnerable_tracts_proj <- st_transform(vulnerable_tracts, 5070)\nhospitals_proj <- st_transform(hospitals, 5070)\n\ntract_centroids <- st_centroid(vulnerable_tracts_proj)\n# Calculate distance from each tract centroid to nearest hospital\ndist_matrix <- st_distance(tract_centroids, hospitals_proj)\nnearest_hospital_dist_m <- apply(dist_matrix, 1, min)\n\nnearest_hospital_dist_miles <- as.numeric(nearest_hospital_dist_m)/1609.34\n\nvulnerable_tracts_proj <- vulnerable_tracts_proj %>%\n  mutate(distance_to_hospital_miles = nearest_hospital_dist_miles)\n\navg_distance <- mean(vulnerable_tracts_proj$distance_to_hospital_miles, na.rm = TRUE)\nmax_distance <- max(vulnerable_tracts_proj$distance_to_hospital_miles, na.rm = TRUE)\nnum_over_15 <- sum(vulnerable_tracts_proj$distance_to_hospital_miles > 15, na.rm = TRUE)\n\ncat(\n  \"Average distance to nearest hospital (miles):\", round(avg_distance, 2), \"\\n\",\n  \"Maximum distance to nearest hospital (miles):\", round(max_distance, 2), \"\\n\",\n  \"Number of vulnerable tracts >15 miles from hospital:\", num_over_15, \"\\n\"\n)\n\n\n```\n\n**Requirements:**\n- Use an appropriate projected coordinate system for Pennsylvania\n- Calculate distances in miles\n- Explain why you chose your projection\n\n**Questions to answer:**<br>\n-  What is the average distance to the nearest hospital for vulnerable tracts?<br>\n   The average distance is 4.75 miles.<br>\n-  What is the maximum distance?<br>\n   The maximum distance is 19.16 miles.<br>\n-  How many vulnerable tracts are more than 15 miles from the nearest hospital?<br>\n   There are 9 tracts are more than 15 miles from the nearest hospital.\n---\n\n#### Step 5: Identify Underserved Areas \n\nDefine \"underserved\" as vulnerable tracts that are more than 15 miles from the nearest hospital.\n\n**Your Task:**\n```{r}\n# Create underserved variable\n\nvulnerable_tracts_proj <- vulnerable_tracts_proj %>%\n  mutate(underserved = distance_to_hospital_miles > 15)\n\nnum_underserved <- sum(vulnerable_tracts_proj$underserved, na.rm = TRUE)\n\n# Percentage of vulnerable tracts that are underserved\nperc_underserved <- num_underserved / nrow(vulnerable_tracts_proj) * 100\n\ncat(\"Number of underserved tracts:\", num_underserved, \"\\n\")\ncat(\"Percentage of vulnerable tracts underserved:\", round(perc_underserved, 2), \"%\\n\")\n\n\n\n\n```\n\n**Questions to answer:**<br>\n-  How many tracts are underserved?<br>\n   There are 9 tracts are underserved.<br>\n-  What percentage of vulnerable tracts are underserved?<br>\n   There are 5.45% of the vulnerable tracts are underserved.<br>\n-  Does this surprise you? Why or why not?<br>\n   It doesn't surprise me. It shows that the hospitals are relatively well_distributed in Pennsylvania that only a small amount of vulnerable tracts are more than 15 miles from the nearest hospital. The few underserved tract are likely in rural areas, however, most of the population concentrated in urban and suburban counties.\n---\n\n#### Step 6: Aggregate to County Level\n\nUse spatial joins and aggregation to calculate county-level statistics about vulnerable populations and hospital access.\n\n**Your Task:**\n```{r}\n# Spatial join tracts to counties\n\npa_counties_proj <- st_transform(pa_counties, 5070)\n\ntract_centroids <- st_centroid(vulnerable_tracts_proj)\ntract_centroids <- cbind(tract_centroids, vulnerable_tracts_proj)\ntracts_with_county <- st_join(tract_centroids, pa_counties_proj, join = st_within)\n\n# Aggregate statistics by county\ncounty_stats <- tracts_with_county %>%\n  group_by(COUNTY_NAM) %>%          \n  summarise(\n    n_vulnerable_tracts = n(),\n    n_underserved = sum(distance_to_hospital_miles > 15, na.rm = TRUE),\n    pct_underserved = n_underserved / n_vulnerable_tracts * 100,\n    avg_distance_miles = mean(distance_to_hospital_miles, na.rm = TRUE),\n    total_vulnerable_pop = sum(total_pop, na.rm = TRUE)\n  ) %>%\n  arrange(desc(pct_underserved))\n\nst_drop_geometry(county_stats)\n\n\n```\n\n\n\n**Required county-level statistics:**\n- Number of vulnerable tracts\n- Number of underserved tracts  \n- Percentage of vulnerable tracts that are underserved\n- Average distance to nearest hospital for vulnerable tracts\n- Total vulnerable population\n\n**Questions to answer:**<br>\n-  Which 5 counties have the highest percentage of underserved vulnerable tracts?<br>\n   The 5 counties are Bradford, Forest, Juniata, Monroe, Sullivan.They all have 1 tract that is vulnerable and undeserved.<br>\n-  Which counties have the most vulnerable people living far from hospitals?<br>\n   Allegheny County has the most vulnerable people ~51790 living far from hospitals.<br>\n-  Are there any patterns in where underserved counties are located?<br>\n   The underserved counties are located in northern and central rural Pennsyvania with relatively low population density.\n---\n\n#### Step 7: Create Summary Table \n\nCreate a professional table showing the top 10 priority counties for healthcare investment.\n\n**Your Task:**\n```{r}\n# Create and format priority counties table\nlibrary(knitr)\nlibrary(dplyr)\nlibrary(scales)\n\npriority_counties <- county_stats %>%\n  arrange(desc(pct_underserved)) %>%\n  mutate(\n    pct_underserved = round(pct_underserved, 1),\n    avg_distance_miles = round(avg_distance_miles, 1),\n    total_vulnerable_pop = comma(total_vulnerable_pop)\n  ) %>%\n  select(\n    County = COUNTY_NAM,\n    `Vulnerable Tracts` = n_vulnerable_tracts,\n    `Underserved Tracts` = n_underserved,\n    `Underserved (%)` = pct_underserved,\n    `Avg Distance to Hospital (miles)` = avg_distance_miles,\n    `Total Vulnerable Population` = total_vulnerable_pop\n  ) \n\npriority_counties_top10 <- priority_counties %>% slice(1:10)\n\nkable(\n  st_drop_geometry(priority_counties),\n  caption = \"Table: Top 10 Priority Counties for Healthcare Investment in Pennsylvania\",\n  align = \"lccccr\",\n  format = \"pipe\"\n)\n\n\n```\n\n**Requirements:**\n- Use `knitr::kable()` or similar for formatting\n- Include descriptive column names\n- Format numbers appropriately (commas for population, percentages, etc.)\n- Add an informative caption\n- Sort by priority (you decide the metric)\n\n---\n\n## Part 2: Comprehensive Visualization \n\nUsing the skills from Week 3 (Data Visualization), create publication-quality maps and charts.\n\n### Map 1: County-Level Choropleth \n\nCreate a choropleth map showing healthcare access challenges at the county level.\n\n**Your Task:**\n```{r}\n# Create county-level access map\nlibrary(ggplot2)\nlibrary(scales)\nlibrary(dplyr)\n\n\npa_counties_map <- pa_counties_proj %>%\n  left_join(\n    priority_counties %>%\n      st_drop_geometry() %>% \n      select(County, `Underserved (%)`),\n    by = c(\"COUNTY_NAM\" = \"County\")\n  )\n\nggplot() +\n  geom_sf(\n    data = pa_counties_map,\n    aes(fill = `Underserved (%)`),\n    color = \"white\", size = 0.25\n  ) +\n  geom_sf(\n    data = hospitals,\n    shape = 21, fill = \"white\", color = \"black\", size = 2, alpha = 0.8\n  ) +\n  scale_fill_viridis_c(\n    option = \"Viridis\",\n    name = \"% Underserved (of vulnerable tracts)\",\n    labels = function(x) paste0(x, \"%\"),\n    na.value = \"grey90\",\n    limits = c(0, 100)\n  ) +\n  labs(\n    title = \"Healthcare Access Challenges in Pennsylvania\",\n    subtitle = \"Percent of vulnerable census tracts that are underserved (>15 miles from nearest hospital)\",\n    caption = \"Sources: ACS 2022 5-year (tidycensus), lecture hospital data, county boundaries\"\n  ) +\n  theme_void() \n```\n\n\n**Requirements:**\n- Fill counties by percentage of vulnerable tracts that are underserved\n- Include hospital locations as points\n- Use an appropriate color scheme\n- Include clear title, subtitle, and caption\n- Use `theme_void()` or similar clean theme\n- Add a legend with formatted labels\n\n---\n\n### Map 2: Detailed Vulnerability Map \n\nCreate a map highlighting underserved vulnerable tracts.\n\n**Your Task:**\n```{r}\n# Create detailed tract-level map\nvulnerable_tracts_proj <- vulnerable_tracts_proj %>%\n  mutate(\n    vulnerable= median_income <= income_threshold &\n                elderly_share >= elderly_threshold\n  ) %>%\n  mutate(\n    tract_status = case_when(\n      vulnerable & underserved ~ \"Underserved & Vulnerable\",\n      vulnerable & !underserved ~ \"Served & Vulnerable\",\n      TRUE ~ \"Other Tracts\"\n  )\n)\n\n  \nggplot()+\n  geom_sf(data = pa_counties_proj, fill = \"grey50\", color = \"white\", size = 0.3) +\n  geom_sf(\n    data = vulnerable_tracts_proj,\n    aes(fill = tract_status),\n    color = NA,\n    alpha = 0.8\n  ) +\n  geom_sf(\n     data = hospitals, shape = 21, fill = \"white\", color = \"black\", size = 2, alpha = 0.8\n  ) +\n  scale_fill_manual(\n    name = \"Tract Status\",\n    values = c(\n      \"Underserved & Vulnerable\" = \"#d7191c\",\n      \"Served & Vulnerable\" = \"#fdae61\",\n      \"Other Tracts\" = \"#cccccc\" \n    )\n  ) +\n  labs(\n    title = \"Underserved Vulnerable Tracts in Pennsylvania\",\n    subtitle = \"Tracts identified as both socially vulnerable and >15 miles from nearest hospital\",\n    caption = \"Sources: ACS 2022 5-year (tidycensus), hospital data, county boundaries\"\n  ) +\n  theme_void()\n  \n\n\n```\n\n**Requirements:**\n- Show underserved vulnerable tracts in a contrasting color\n- Include county boundaries for context\n- Show hospital locations\n- Use appropriate visual hierarchy (what should stand out?)\n- Include informative title and subtitle\n\n---\n\n### Chart: Distribution Analysis\n\nCreate a visualization showing the distribution of distances to hospitals for vulnerable populations.\n\n**Your Task:**\n```{r}\n# Create distribution visualization\nggplot(vulnerable_tracts_proj, aes(x = distance_to_hospital_miles)) +\n  geom_histogram(bins = 20, fill = \"#4575b4\", color = \"white\", alpha = 0.8) +\n  geom_vline(xintercept = 15, color = \"#d7191c\", linetype = \"dashed\", size = 1) +\n  labs(\n    title = \"Distribution of Distance to Nearest Hospital for Vulnerable Tracts\",\n    x = \"Distance to Nearest Hospital (miles)\",\n    y = \"Number of Vulnerable Tracts\",\n    caption = \"Dashed line indicates 15-mile threshold for underserved classification\"\n  ) +\n  theme_minimal(base_size = 12)\n\n\n```\n\n**Suggested chart types:**\n- Histogram or density plot of distances\n- Box plot comparing distances across regions\n- Bar chart of underserved tracts by county\n- Scatter plot of distance vs. vulnerable population size\n\n**Requirements:**\n- Clear axes labels with units\n- Appropriate title\n- Professional formatting\n- Brief interpretation (1-2 sentences as a caption or in text)\n\n---\n\n## Part 3: Bring Your Own Data Analysis \n\n\n#### Environmental Justice\n\n**Option C: Green Space Equity** \n- **Data:** Parks, Street Trees, Census tracts (race/income demographics)\n- **Question:** \"Do low-income and minority neighborhoods have equitable access to green space?\"\n- **Operations:** Buffer parks (10-minute walk = 0.5 mile), calculate tree canopy or park acreage per capita, compare by demographics\n- **Policy relevance:** Climate resilience, environmental justice, urban forestry investment\n---\n**Your Task:**\n\n1. **Find and load additional data**\n   - Document your data source\n   - Check and standardize the CRS\n   - Provide basic summary statistics\n\n\n```{r}\n# Load your additional dataset\nlibrary(sf)\nparks <- st_read(\"PPR_Program_Sites.geojson\")\nparks <- st_transform(parks, crs = 3857)  # Web Mercator\n\n\nvars <- c(\n  median_income = \"B19013_001\",\n  total_pop = \"B02001_001\",\n  white_pop = \"B02001_002\"\n)\n\nphl_tracts <- get_acs(\n  geography = \"tract\",\n  variables = vars,\n  state = \"PA\",\n  county = \"Philadelphia\",\n  geometry = TRUE,   \n  year = 2023,\n  progress_bar = FALSE\n) %>%\n  select(GEOID, NAME, variable, estimate, geometry) %>%\n  tidyr::pivot_wider(names_from = variable, values_from = estimate) %>%\n  mutate(\n    minority_share = (total_pop - white_pop) / total_pop * 100\n  )\n\nhead(phl_tracts)\nsummary(trees)\n```\n\n\n**Questions to answer:**<br>\n- What dataset did you choose and why?<br>\n  I chose the Philadelphia parks dataset because public parks represent accessible green space for residents. Analyzing their distribution helps assess equity in green space access across different neighborhoods.<br>\n- What is the data source and date?<br>\n  The dataset comes from OpenDataPhilly, specifically the “PPR Program Sites” dataset, most recently updated in 2023.<br>\n- How many features does it contain?<br>\n  The dataset contains 171 park features.<br>\n- What CRS is it in? Did you need to transform it?<br>\n  The parks dataset was originally in WGS84 (EPSG:4326). For consistency with other spatial layers and to facilitate distance and area calculations, I transformed it to EPSG:3857 (Web Mercator projection).\n---\n\n2. **Pose a research question**\n\nDo low-income and minority neighborhoods in Philadelphia have equitable access to green spaces within a 10-minute walk distance?\n\n\n---\n\n3. **Conduct spatial analysis**\n\nUse at least TWO spatial operations to answer your research question.\n\n**Required operations (choose 2+):**\n- Buffers\n- Spatial joins\n- Spatial filtering with predicates\n- Distance calculations\n- Intersections or unions\n- Point-in-polygon aggregation\n\n**Your Task:**\n```{r}\n# Your spatial analysis\n# buffer a 0.5 mile distance from the park polygon ~10min\nparks_buffer <- st_buffer(parks, dist = 800)\nparks_buffer <- st_transform(parks_buffer, st_crs(phl_tracts))\n\n\n\n#  Spatial join to identify tracts within 0.5 miles of any park \ncensus_access <- phl_tracts %>%\n  mutate(has_access = lengths(st_intersects(geometry, parks_buffer)) > 0)\n\n# Summary statistics \naccess_summary <- census_access %>%\n  group_by(income_group = case_when(\n    median_income < median(median_income, na.rm = TRUE) ~ \"Low Income\",\n    TRUE ~ \"High Income\"\n  )) %>%\n  summarise(\n    total_tracts = n(),\n    tracts_with_access = sum(has_access),\n    pct_with_access = round(mean(has_access) * 100, 1)\n  )\n\nprint(access_summary)\n\n```\n\n\n\n\n```{r}\n\n\nggplot() +\n  geom_sf(data = census_access, aes(fill = median_income), color = \"white\", size = 0.1) +\n  \n  geom_sf(\n    data = parks_buffer,\n    fill = \"#32CD32\", alpha = 0.25, color = NA\n  ) +\n  \n  geom_sf(\n    data = parks,\n    color = \"#228B22\", size = 1.2\n  ) +\n\n scale_fill_gradientn(\n  name = \"Median Household Income ($)\",\n  colors = c(\"#4575b4\", \"#91bfdb\", \"#fdae61\",\"orange\", \"#d73027\")\n  ) +\n  \n  labs(\n    title = \"Philadelphia Census Tracts by Income and Park Accessibility\",\n    subtitle = \"Red shaded areas represent 500 m park buffer zones\",\n    caption = \"Data: OpenDataPhilly Parks, ACS 2021\"\n  ) +\n  \n  theme_minimal() \n\n\n\n```\n\n\n\n\n**Your interpretation:**\n\nThe table shows that park accessibility is 87.2% in high-income areas and slightly higher at 95.3% in low-income areas, indicating that not all high-income tracts are near parks, though there is a cluster of parks in moderate-income areas in South Philly. Maps show that parks and housing are more concentrated in the city center and low-income areas, while high-income areas in the northwest, northeast, and south are larger but have more dispersed parks. This likely reflects land use and planning: low-density neighborhoods with private yards leave fewer public parks. Overall, park distribution appears influenced more by urban layout and planning than by income alone.\n\n\n## Finally - A few comments about your incorporation of feedback!\nI really appreciated the detailed feedback on my first assignment. It suggested that I clean up unnecessary content and remove figures that didn’t need to be displayed. Following this advice, I tried to clean my Markdown document this time to try to make it look much cleaner and more professional. I hope to continue improving in this way with future assignments.\n\n\n","srcMarkdownNoYaml":"\n\n## Assignment Overview\n\n**Learning Objectives:**\n- Apply spatial operations to answer policy-relevant research questions\n- Integrate census demographic data with spatial analysis\n- Create publication-quality visualizations and maps\n- Work with spatial data from multiple sources\n- Communicate findings effectively for policy audiences\n\n---\n\n## Part 1: Healthcare Access for Vulnerable Populations\n\n### Research Question\n\n**Which Pennsylvania counties have the highest proportion of vulnerable populations (elderly + low-income) living far from hospitals?**\n\n\n#### Step 1: Data Collection (5 points)\n\nLoad the required spatial data:\n- Pennsylvania county boundaries\n- Pennsylvania hospitals (from lecture data)\n- Pennsylvania census tracts\n\n**Your Task:**\n```{r}\n# Load required packages\n\nlibrary(sf)\nlibrary(tidyverse)\nlibrary(tigris)\nlibrary(tidycensus)\nlibrary(scales)\nlibrary(patchwork)\nlibrary(here)\n\n# Set Census API key\ncensus_api_key(\"e173851c633e89c20243632174db68f63bac8856\")\n\n# Load spatial data\n\npa_counties <- st_read(here(\"assignments/assignments2/data/Pennsylvania_County_Boundaries.shp\"))\nhospitals <- st_read(here(\"assignments/assignments2/data/hospitals.geojson\"))\ncensus_tracts <- tracts(state = \"PA\", cb = TRUE, progress_bar = FALSE)\n\n\n# Standardize CRS\nhospitals <- st_transform(hospitals, st_crs(pa_counties))\ncensus_tracts <- st_transform(census_tracts, st_crs(pa_counties))\n\n# check that all data loaded correctly\n\n# Number of hospitals\nn_hospitals <- nrow(hospitals)\n\n\n# Number of census tracts\nn_tracts <- nrow(census_tracts)\n\ncat(\"Number of hospitals:\", nrow(hospitals), \"\\n\")\ncat(\"Number of census tracts:\", nrow(census_tracts), \"\\n\")\n\ncat(\"\\nCoordinate Reference Systems (CRS):\\n\")\ncat(\"Counties:\", st_crs(pa_counties)$input, \"\\n\")\ncat(\"Hospitals:\", st_crs(hospitals)$input, \"\\n\")\ncat(\"Census tracts:\", st_crs(census_tracts)$input, \"\\n\")\n\n\n```\n\n# Check that all data loaded correctly\n\n\n**Questions to answer:**<br>\n-  How many hospitals are in your dataset?<br>\n   There are 223 hospitals in the dataset.<br>\n-  How many census tracts?<br>\n   There are 3445 census tracts.<br>\n-  What coordinate reference system is each dataset in?<br>\n   They share the same coordinate reference system: WGS 84.\n\n---\n\n#### Step 2: Get Demographic Data \n\nUse `tidycensus` to download tract-level demographic data for Pennsylvania.\n\n**Required variables:**\n- Total population\n- Median household income\n- Population 65 years and over (you may need to sum multiple age categories)\n\n**Your Task:**\n\n\n\n```{r}\n# Get demographic data from ACS\n#### Step 2: Get Demographic Data ----\n\npa_demo <- get_acs(\n  geography = \"tract\",\n  state = \"PA\",\n  year = 2022,             \n  survey = \"acs5\",\n  variables = c(\n    total_pop = \"B01003_001\",       # Total population\n    median_income = \"B19013_001\",   # Median household income\n    age_65_66 = \"B01001_020\",       # Male 65–66\n    age_67_69 = \"B01001_021\",\n    age_70_74 = \"B01001_022\",\n    age_75_79 = \"B01001_023\",\n    age_80_84 = \"B01001_024\",\n    age_85_plus = \"B01001_025\",\n    f_65_66 = \"B01001_044\",         # Female 65–66\n    f_67_69 = \"B01001_045\",\n    f_70_74 = \"B01001_046\",\n    f_75_79 = \"B01001_047\",\n    f_80_84 = \"B01001_048\",\n    f_85_plus = \"B01001_049\"\n  ),\n  output = \"wide\"\n)\n\n\npa_demo <- pa_demo %>%\n  mutate(\n    pop_65_over = age_65_66E + age_67_69E + age_70_74E + age_75_79E +\n                  age_80_84E + age_85_plusE +\n                  f_65_66E + f_67_69E + f_70_74E + f_75_79E +\n                  f_80_84E + f_85_plusE\n  ) %>%\n  select(GEOID, total_pop = total_popE, median_income = median_incomeE, pop_65_over)\n\n\n\n# Join to tract boundaries\ncensus_tracts_demo <- census_tracts %>%\n  left_join(pa_demo, by = \"GEOID\")\n\n\n# 1. What year of ACS data are you using?\nacs_year <- 2022\ncat(\"ACS Year Used:\", acs_year, \"\\n\")\n\n# 2. How many tracts have missing income data?\nmissing_income <- sum(is.na(census_tracts_demo$median_income))\ncat(\"Number of tracts with missing income data:\", missing_income, \"\\n\")\n\n# 3. What is the median income across all PA census tracts?\nmedian_income_pa <- median(census_tracts_demo$median_income, na.rm = TRUE)\ncat(\"Median income across all PA census tracts:\", dollar(median_income_pa), \"\\n\")\n\n\n\n```\n\n\n**Questions to answer:**<br>\n-  What year of ACS data are you using?<br>\n   I used data of 2022.<br>\n-  How many tracts have missing income data?<br>\n   There are 62 tracts missing.<br>\n-  What is the median income across all PA census tracts?<br>\n   The medium income across all PA census tracts is $70,188. \n---\n\n#### Step 3: Define Vulnerable Populations \n\nIdentify census tracts with vulnerable populations based on TWO criteria:\n1. Low median household income (choose an appropriate threshold)\n2. Significant elderly population (choose an appropriate threshold)\n\n**Your Task:**\n```{r}\n# Filter for vulnerable tracts based on your criteria\nincome_threshold <- quantile(census_tracts_demo$median_income, 0.25, na.rm = TRUE)\nelderly_threshold <- quantile(\n  (census_tracts_demo$pop_65_over / census_tracts_demo$total_pop), \n  0.75, \n  na.rm = TRUE\n)\n\ncat(\"Low-income threshold:\", scales::dollar(income_threshold), \"\\n\")\ncat(\"High-elderly threshold (share of 65+):\", scales::percent(elderly_threshold), \"\\n\")\n\ncensus_tracts_demo <- census_tracts_demo %>%\n  mutate(\n    elderly_share = pop_65_over / total_pop\n  )\n\nvulnerable_tracts <- census_tracts_demo %>%\n  filter(\n    median_income <= income_threshold &\n    elderly_share >= elderly_threshold\n  )\ncat(\"Number of vulnerable tracts identified:\", nrow(vulnerable_tracts), \"\\n\")\n\ntotal_tracts <- nrow(census_tracts_demo)\nvulnerable_count <- nrow(vulnerable_tracts)\nvulnerable_pct <- (vulnerable_count / total_tracts) * 100\ncat(\"Percentage of PA census tracts considered vulnerable:\", round(vulnerable_pct, 1), \"%\\n\")\n\n```\n\n**Questions to answer:**<br>\n-  What income threshold did you choose and why?<br>\n   I used $55,923.50 has the income threshold. It is based on the percentiles of the general income data and this is the benchmarks of the bottom 25% of the income across Pennsylvania counties.<br>\n-  What elderly population threshold did you choose and why?<br>\n   I used the same method as for the income threshold. I used the top 25% elderly share(23%) as my threshold. <br>\n-  How many tracts meet your vulnerability criteria?<br>\n   There are 165 tracts meet my vulnerability criteria.<br>\n-  What percentage of PA census tracts are considered vulnerable by your definition?<br>\n   There are 4.8% of PA census tracts that are vulnerable.\n---\n\n#### Step 4: Calculate Distance to Hospitals \n\nFor each vulnerable tract, calculate the distance to the nearest hospital.\n\n**Your Task:**\n```{r}\n# Transform to appropriate projected CRS\nlibrary(units)\nvulnerable_tracts_proj <- st_transform(vulnerable_tracts, 5070)\nhospitals_proj <- st_transform(hospitals, 5070)\n\ntract_centroids <- st_centroid(vulnerable_tracts_proj)\n# Calculate distance from each tract centroid to nearest hospital\ndist_matrix <- st_distance(tract_centroids, hospitals_proj)\nnearest_hospital_dist_m <- apply(dist_matrix, 1, min)\n\nnearest_hospital_dist_miles <- as.numeric(nearest_hospital_dist_m)/1609.34\n\nvulnerable_tracts_proj <- vulnerable_tracts_proj %>%\n  mutate(distance_to_hospital_miles = nearest_hospital_dist_miles)\n\navg_distance <- mean(vulnerable_tracts_proj$distance_to_hospital_miles, na.rm = TRUE)\nmax_distance <- max(vulnerable_tracts_proj$distance_to_hospital_miles, na.rm = TRUE)\nnum_over_15 <- sum(vulnerable_tracts_proj$distance_to_hospital_miles > 15, na.rm = TRUE)\n\ncat(\n  \"Average distance to nearest hospital (miles):\", round(avg_distance, 2), \"\\n\",\n  \"Maximum distance to nearest hospital (miles):\", round(max_distance, 2), \"\\n\",\n  \"Number of vulnerable tracts >15 miles from hospital:\", num_over_15, \"\\n\"\n)\n\n\n```\n\n**Requirements:**\n- Use an appropriate projected coordinate system for Pennsylvania\n- Calculate distances in miles\n- Explain why you chose your projection\n\n**Questions to answer:**<br>\n-  What is the average distance to the nearest hospital for vulnerable tracts?<br>\n   The average distance is 4.75 miles.<br>\n-  What is the maximum distance?<br>\n   The maximum distance is 19.16 miles.<br>\n-  How many vulnerable tracts are more than 15 miles from the nearest hospital?<br>\n   There are 9 tracts are more than 15 miles from the nearest hospital.\n---\n\n#### Step 5: Identify Underserved Areas \n\nDefine \"underserved\" as vulnerable tracts that are more than 15 miles from the nearest hospital.\n\n**Your Task:**\n```{r}\n# Create underserved variable\n\nvulnerable_tracts_proj <- vulnerable_tracts_proj %>%\n  mutate(underserved = distance_to_hospital_miles > 15)\n\nnum_underserved <- sum(vulnerable_tracts_proj$underserved, na.rm = TRUE)\n\n# Percentage of vulnerable tracts that are underserved\nperc_underserved <- num_underserved / nrow(vulnerable_tracts_proj) * 100\n\ncat(\"Number of underserved tracts:\", num_underserved, \"\\n\")\ncat(\"Percentage of vulnerable tracts underserved:\", round(perc_underserved, 2), \"%\\n\")\n\n\n\n\n```\n\n**Questions to answer:**<br>\n-  How many tracts are underserved?<br>\n   There are 9 tracts are underserved.<br>\n-  What percentage of vulnerable tracts are underserved?<br>\n   There are 5.45% of the vulnerable tracts are underserved.<br>\n-  Does this surprise you? Why or why not?<br>\n   It doesn't surprise me. It shows that the hospitals are relatively well_distributed in Pennsylvania that only a small amount of vulnerable tracts are more than 15 miles from the nearest hospital. The few underserved tract are likely in rural areas, however, most of the population concentrated in urban and suburban counties.\n---\n\n#### Step 6: Aggregate to County Level\n\nUse spatial joins and aggregation to calculate county-level statistics about vulnerable populations and hospital access.\n\n**Your Task:**\n```{r}\n# Spatial join tracts to counties\n\npa_counties_proj <- st_transform(pa_counties, 5070)\n\ntract_centroids <- st_centroid(vulnerable_tracts_proj)\ntract_centroids <- cbind(tract_centroids, vulnerable_tracts_proj)\ntracts_with_county <- st_join(tract_centroids, pa_counties_proj, join = st_within)\n\n# Aggregate statistics by county\ncounty_stats <- tracts_with_county %>%\n  group_by(COUNTY_NAM) %>%          \n  summarise(\n    n_vulnerable_tracts = n(),\n    n_underserved = sum(distance_to_hospital_miles > 15, na.rm = TRUE),\n    pct_underserved = n_underserved / n_vulnerable_tracts * 100,\n    avg_distance_miles = mean(distance_to_hospital_miles, na.rm = TRUE),\n    total_vulnerable_pop = sum(total_pop, na.rm = TRUE)\n  ) %>%\n  arrange(desc(pct_underserved))\n\nst_drop_geometry(county_stats)\n\n\n```\n\n\n\n**Required county-level statistics:**\n- Number of vulnerable tracts\n- Number of underserved tracts  \n- Percentage of vulnerable tracts that are underserved\n- Average distance to nearest hospital for vulnerable tracts\n- Total vulnerable population\n\n**Questions to answer:**<br>\n-  Which 5 counties have the highest percentage of underserved vulnerable tracts?<br>\n   The 5 counties are Bradford, Forest, Juniata, Monroe, Sullivan.They all have 1 tract that is vulnerable and undeserved.<br>\n-  Which counties have the most vulnerable people living far from hospitals?<br>\n   Allegheny County has the most vulnerable people ~51790 living far from hospitals.<br>\n-  Are there any patterns in where underserved counties are located?<br>\n   The underserved counties are located in northern and central rural Pennsyvania with relatively low population density.\n---\n\n#### Step 7: Create Summary Table \n\nCreate a professional table showing the top 10 priority counties for healthcare investment.\n\n**Your Task:**\n```{r}\n# Create and format priority counties table\nlibrary(knitr)\nlibrary(dplyr)\nlibrary(scales)\n\npriority_counties <- county_stats %>%\n  arrange(desc(pct_underserved)) %>%\n  mutate(\n    pct_underserved = round(pct_underserved, 1),\n    avg_distance_miles = round(avg_distance_miles, 1),\n    total_vulnerable_pop = comma(total_vulnerable_pop)\n  ) %>%\n  select(\n    County = COUNTY_NAM,\n    `Vulnerable Tracts` = n_vulnerable_tracts,\n    `Underserved Tracts` = n_underserved,\n    `Underserved (%)` = pct_underserved,\n    `Avg Distance to Hospital (miles)` = avg_distance_miles,\n    `Total Vulnerable Population` = total_vulnerable_pop\n  ) \n\npriority_counties_top10 <- priority_counties %>% slice(1:10)\n\nkable(\n  st_drop_geometry(priority_counties),\n  caption = \"Table: Top 10 Priority Counties for Healthcare Investment in Pennsylvania\",\n  align = \"lccccr\",\n  format = \"pipe\"\n)\n\n\n```\n\n**Requirements:**\n- Use `knitr::kable()` or similar for formatting\n- Include descriptive column names\n- Format numbers appropriately (commas for population, percentages, etc.)\n- Add an informative caption\n- Sort by priority (you decide the metric)\n\n---\n\n## Part 2: Comprehensive Visualization \n\nUsing the skills from Week 3 (Data Visualization), create publication-quality maps and charts.\n\n### Map 1: County-Level Choropleth \n\nCreate a choropleth map showing healthcare access challenges at the county level.\n\n**Your Task:**\n```{r}\n# Create county-level access map\nlibrary(ggplot2)\nlibrary(scales)\nlibrary(dplyr)\n\n\npa_counties_map <- pa_counties_proj %>%\n  left_join(\n    priority_counties %>%\n      st_drop_geometry() %>% \n      select(County, `Underserved (%)`),\n    by = c(\"COUNTY_NAM\" = \"County\")\n  )\n\nggplot() +\n  geom_sf(\n    data = pa_counties_map,\n    aes(fill = `Underserved (%)`),\n    color = \"white\", size = 0.25\n  ) +\n  geom_sf(\n    data = hospitals,\n    shape = 21, fill = \"white\", color = \"black\", size = 2, alpha = 0.8\n  ) +\n  scale_fill_viridis_c(\n    option = \"Viridis\",\n    name = \"% Underserved (of vulnerable tracts)\",\n    labels = function(x) paste0(x, \"%\"),\n    na.value = \"grey90\",\n    limits = c(0, 100)\n  ) +\n  labs(\n    title = \"Healthcare Access Challenges in Pennsylvania\",\n    subtitle = \"Percent of vulnerable census tracts that are underserved (>15 miles from nearest hospital)\",\n    caption = \"Sources: ACS 2022 5-year (tidycensus), lecture hospital data, county boundaries\"\n  ) +\n  theme_void() \n```\n\n\n**Requirements:**\n- Fill counties by percentage of vulnerable tracts that are underserved\n- Include hospital locations as points\n- Use an appropriate color scheme\n- Include clear title, subtitle, and caption\n- Use `theme_void()` or similar clean theme\n- Add a legend with formatted labels\n\n---\n\n### Map 2: Detailed Vulnerability Map \n\nCreate a map highlighting underserved vulnerable tracts.\n\n**Your Task:**\n```{r}\n# Create detailed tract-level map\nvulnerable_tracts_proj <- vulnerable_tracts_proj %>%\n  mutate(\n    vulnerable= median_income <= income_threshold &\n                elderly_share >= elderly_threshold\n  ) %>%\n  mutate(\n    tract_status = case_when(\n      vulnerable & underserved ~ \"Underserved & Vulnerable\",\n      vulnerable & !underserved ~ \"Served & Vulnerable\",\n      TRUE ~ \"Other Tracts\"\n  )\n)\n\n  \nggplot()+\n  geom_sf(data = pa_counties_proj, fill = \"grey50\", color = \"white\", size = 0.3) +\n  geom_sf(\n    data = vulnerable_tracts_proj,\n    aes(fill = tract_status),\n    color = NA,\n    alpha = 0.8\n  ) +\n  geom_sf(\n     data = hospitals, shape = 21, fill = \"white\", color = \"black\", size = 2, alpha = 0.8\n  ) +\n  scale_fill_manual(\n    name = \"Tract Status\",\n    values = c(\n      \"Underserved & Vulnerable\" = \"#d7191c\",\n      \"Served & Vulnerable\" = \"#fdae61\",\n      \"Other Tracts\" = \"#cccccc\" \n    )\n  ) +\n  labs(\n    title = \"Underserved Vulnerable Tracts in Pennsylvania\",\n    subtitle = \"Tracts identified as both socially vulnerable and >15 miles from nearest hospital\",\n    caption = \"Sources: ACS 2022 5-year (tidycensus), hospital data, county boundaries\"\n  ) +\n  theme_void()\n  \n\n\n```\n\n**Requirements:**\n- Show underserved vulnerable tracts in a contrasting color\n- Include county boundaries for context\n- Show hospital locations\n- Use appropriate visual hierarchy (what should stand out?)\n- Include informative title and subtitle\n\n---\n\n### Chart: Distribution Analysis\n\nCreate a visualization showing the distribution of distances to hospitals for vulnerable populations.\n\n**Your Task:**\n```{r}\n# Create distribution visualization\nggplot(vulnerable_tracts_proj, aes(x = distance_to_hospital_miles)) +\n  geom_histogram(bins = 20, fill = \"#4575b4\", color = \"white\", alpha = 0.8) +\n  geom_vline(xintercept = 15, color = \"#d7191c\", linetype = \"dashed\", size = 1) +\n  labs(\n    title = \"Distribution of Distance to Nearest Hospital for Vulnerable Tracts\",\n    x = \"Distance to Nearest Hospital (miles)\",\n    y = \"Number of Vulnerable Tracts\",\n    caption = \"Dashed line indicates 15-mile threshold for underserved classification\"\n  ) +\n  theme_minimal(base_size = 12)\n\n\n```\n\n**Suggested chart types:**\n- Histogram or density plot of distances\n- Box plot comparing distances across regions\n- Bar chart of underserved tracts by county\n- Scatter plot of distance vs. vulnerable population size\n\n**Requirements:**\n- Clear axes labels with units\n- Appropriate title\n- Professional formatting\n- Brief interpretation (1-2 sentences as a caption or in text)\n\n---\n\n## Part 3: Bring Your Own Data Analysis \n\n\n#### Environmental Justice\n\n**Option C: Green Space Equity** \n- **Data:** Parks, Street Trees, Census tracts (race/income demographics)\n- **Question:** \"Do low-income and minority neighborhoods have equitable access to green space?\"\n- **Operations:** Buffer parks (10-minute walk = 0.5 mile), calculate tree canopy or park acreage per capita, compare by demographics\n- **Policy relevance:** Climate resilience, environmental justice, urban forestry investment\n---\n**Your Task:**\n\n1. **Find and load additional data**\n   - Document your data source\n   - Check and standardize the CRS\n   - Provide basic summary statistics\n\n\n```{r}\n# Load your additional dataset\nlibrary(sf)\nparks <- st_read(\"PPR_Program_Sites.geojson\")\nparks <- st_transform(parks, crs = 3857)  # Web Mercator\n\n\nvars <- c(\n  median_income = \"B19013_001\",\n  total_pop = \"B02001_001\",\n  white_pop = \"B02001_002\"\n)\n\nphl_tracts <- get_acs(\n  geography = \"tract\",\n  variables = vars,\n  state = \"PA\",\n  county = \"Philadelphia\",\n  geometry = TRUE,   \n  year = 2023,\n  progress_bar = FALSE\n) %>%\n  select(GEOID, NAME, variable, estimate, geometry) %>%\n  tidyr::pivot_wider(names_from = variable, values_from = estimate) %>%\n  mutate(\n    minority_share = (total_pop - white_pop) / total_pop * 100\n  )\n\nhead(phl_tracts)\nsummary(trees)\n```\n\n\n**Questions to answer:**<br>\n- What dataset did you choose and why?<br>\n  I chose the Philadelphia parks dataset because public parks represent accessible green space for residents. Analyzing their distribution helps assess equity in green space access across different neighborhoods.<br>\n- What is the data source and date?<br>\n  The dataset comes from OpenDataPhilly, specifically the “PPR Program Sites” dataset, most recently updated in 2023.<br>\n- How many features does it contain?<br>\n  The dataset contains 171 park features.<br>\n- What CRS is it in? Did you need to transform it?<br>\n  The parks dataset was originally in WGS84 (EPSG:4326). For consistency with other spatial layers and to facilitate distance and area calculations, I transformed it to EPSG:3857 (Web Mercator projection).\n---\n\n2. **Pose a research question**\n\nDo low-income and minority neighborhoods in Philadelphia have equitable access to green spaces within a 10-minute walk distance?\n\n\n---\n\n3. **Conduct spatial analysis**\n\nUse at least TWO spatial operations to answer your research question.\n\n**Required operations (choose 2+):**\n- Buffers\n- Spatial joins\n- Spatial filtering with predicates\n- Distance calculations\n- Intersections or unions\n- Point-in-polygon aggregation\n\n**Your Task:**\n```{r}\n# Your spatial analysis\n# buffer a 0.5 mile distance from the park polygon ~10min\nparks_buffer <- st_buffer(parks, dist = 800)\nparks_buffer <- st_transform(parks_buffer, st_crs(phl_tracts))\n\n\n\n#  Spatial join to identify tracts within 0.5 miles of any park \ncensus_access <- phl_tracts %>%\n  mutate(has_access = lengths(st_intersects(geometry, parks_buffer)) > 0)\n\n# Summary statistics \naccess_summary <- census_access %>%\n  group_by(income_group = case_when(\n    median_income < median(median_income, na.rm = TRUE) ~ \"Low Income\",\n    TRUE ~ \"High Income\"\n  )) %>%\n  summarise(\n    total_tracts = n(),\n    tracts_with_access = sum(has_access),\n    pct_with_access = round(mean(has_access) * 100, 1)\n  )\n\nprint(access_summary)\n\n```\n\n\n\n\n```{r}\n\n\nggplot() +\n  geom_sf(data = census_access, aes(fill = median_income), color = \"white\", size = 0.1) +\n  \n  geom_sf(\n    data = parks_buffer,\n    fill = \"#32CD32\", alpha = 0.25, color = NA\n  ) +\n  \n  geom_sf(\n    data = parks,\n    color = \"#228B22\", size = 1.2\n  ) +\n\n scale_fill_gradientn(\n  name = \"Median Household Income ($)\",\n  colors = c(\"#4575b4\", \"#91bfdb\", \"#fdae61\",\"orange\", \"#d73027\")\n  ) +\n  \n  labs(\n    title = \"Philadelphia Census Tracts by Income and Park Accessibility\",\n    subtitle = \"Red shaded areas represent 500 m park buffer zones\",\n    caption = \"Data: OpenDataPhilly Parks, ACS 2021\"\n  ) +\n  \n  theme_minimal() \n\n\n\n```\n\n\n\n\n**Your interpretation:**\n\nThe table shows that park accessibility is 87.2% in high-income areas and slightly higher at 95.3% in low-income areas, indicating that not all high-income tracts are near parks, though there is a cluster of parks in moderate-income areas in South Philly. Maps show that parks and housing are more concentrated in the city center and low-income areas, while high-income areas in the northwest, northeast, and south are larger but have more dispersed parks. This likely reflects land use and planning: low-density neighborhoods with private yards leave fewer public parks. Overall, park distribution appears influenced more by urban layout and planning than by income alone.\n\n\n## Finally - A few comments about your incorporation of feedback!\nI really appreciated the detailed feedback on my first assignment. It suggested that I clean up unnecessary content and remove figures that didn’t need to be displayed. Following this advice, I tried to clean my Markdown document this time to try to make it look much cleaner and more professional. I hope to continue improving in this way with future assignments.\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"embed-resources":true,"output-file":"assignment2_template.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.8.24","theme":"cosmo","title":"Assignment 2: Spatial Analysis and Visualization","subtitle":"Healthcare Access and Equity in Pennsylvania","author":"Sihan Yu","date":"today","toc-location":"left"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}